# 分布式缓存

## 需要解决的问题

### 1.客户端与缓存服务通信

- 虽然只有一个接口，但为了后续可能存在的接口增加，不使用tcp直接通信。使用rpc通信

### 2.key的拥有者

- 使用一致性hash让相同的key匹配到同一主机

## 架构

客户端使用一致性哈希算法，同样的key从同一缓存服务通过grpc通信获取

- 客户端get(key, load)
- 得到key拥有者，rpc通信获取值，有则返回
- 没有则load()，并告诉key的拥有者这个值

### 接口

- 服务端实现Get和Set
- 客户端实现Get(key, load)

## 实现

### 一致性hash

使用crc32算法将字符串转为数字，在通过二分查找，找到最近的key。为了解决key太少的问题，引入圈数变量，一个key生成圈数多个key：key1，key2...